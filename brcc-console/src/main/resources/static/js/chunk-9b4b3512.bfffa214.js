(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9b4b3512"],{"6d67":function(t,e,a){"use strict";var n=a("5ca1"),r=a("0a49")(1);n(n.P+n.F*!a("2f21")([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},"75fc":function(t,e,a){"use strict";a.d(e,"a",(function(){return h}));var n=a("a745"),r=a.n(n),i=a("db2a");function o(t){if(r()(t))return Object(i["a"])(t)}var c=a("67bb"),s=a.n(c),u=a("c8bb"),l=a.n(u),d=a("774e"),p=a.n(d);function f(t){if("undefined"!==typeof s.a&&l()(Object(t)))return p()(t)}var m=a("e630");function b(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t){return o(t)||f(t)||Object(m["a"])(t)||b()}},b3a9:function(t,e,a){"use strict";a("bb33")},bb33:function(t,e,a){},c4a1:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-card",{attrs:{bordered:!1}},[a("section",{staticClass:"add-btn"},[a("a-breadcrumb",{staticClass:"title"},[a("a-breadcrumb-item",{staticClass:"font-menu"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.routerTo("/index")}}},[t._v("首页")])]),a("a-breadcrumb-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.routerTo("/productLine")}}},[t._v(t._s(t.productName)+"-产品线")])]),a("a-breadcrumb-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.routerTo("/listProject?productId="+t.productId)}}},[t._v(t._s(t.projectName)+"-工程")])]),a("a-breadcrumb-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.routerTo("/listEnv?projectId="+t.projectId)}}},[t._v(t._s(t.environmentName)+"-环境")])]),a("a-breadcrumb-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.routerTo("/listVersion?environmentId="+t.environmentId)}}},[t._v(t._s(t.versionName)+"-版本")])]),a("a-breadcrumb-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.routerTo("/listConfigGroup?versionId="+t.versionId)}}},[t._v(t._s(t.groupName)+"-分组")])]),a("a-breadcrumb-item",[t._v("\n                配置项列表\n            ")])],1)],1),a("a-divider",{staticClass:"divider"}),a("section",{staticClass:"content"},[[a("a-tabs",{staticClass:"mt-10",attrs:{type:"card"}},[a("a-tab-pane",{key:"1",attrs:{tab:"逐条维护","default-active-key":""}},[[a("a-table",{attrs:{pagination:!1,loading:t.loading,columns:t.columns,"data-source":t.tableData,"row-key":function(t){return t.id}},scopedSlots:t._u([t._l(["name","val","memo"],(function(e){return{key:e,fn:function(n,r,i){return[a("div",{key:e},[r.editable?a("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:n},on:{change:function(a){return t.handleChange(a.target.value,r.key,e,i)}}}):[a("span",{staticStyle:{"word-break":"break-all"}},[t._v(t._s(n))])]],2)]}}})),{key:"operation",fn:function(e,n,r){return[a("div",{staticClass:"editable-row-operations"},[n.editable?a("span",[a("a",{on:{click:function(){return t.save(n.key,r)}}},[t._v("保存")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确认取消？","cancel-text":"取消","ok-text":"确认"},on:{confirm:function(){return t.cancel(n.key,r)}}},[a("a",[t._v("取消")])])],1):a("span",[t.canManage?a("a",{on:{click:function(){return t.edit(n.key,r)}}},[t._v("编辑")]):t._e(),a("a-divider",{attrs:{type:"vertical"}}),t.canManage?a("a-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(e){return t.handleDelete(n)}}},[a("a",{attrs:{href:"javascript:;",type:"primary"}},[t._v(" 删除 ")])]):t._e()],1)])]}}],null,!0)})],t.canManage?a("a-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",block:"",icon:"plus"},on:{click:t.addNewData}},[t._v("新增配置")]):t._e()],2),a("a-tab-pane",{key:"2",attrs:{tab:"批量维护"}},[t.errorMsg?a("span",{staticStyle:{color:"red"}},[t._v("备注请用#开头表示")]):a("span",[t._v("备注用#号")]),t.canManage?a("a-button",{staticClass:"save-btn",attrs:{type:"primary"},on:{click:function(e){return t.addList()}}},[t._v("保存修改")]):t._e(),[a("a-textarea",{attrs:{placeholder:"在此贴入配置项，每行一条"},model:{value:t.changeData,callback:function(e){t.changeData=e},expression:"changeData"}})]],2)],1)]],2)],1)},r=[],i=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("ac6a"),a("456d"),a("57e7"),a("28a5"),a("d25f"),a("75fc")),o=(a("7f7f"),a("96cf"),a("3b8d")),c=a("bd86");a("6d67");function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var l=[],d=[{title:"key",dataIndex:"name",width:"25%",scopedSlots:{customRender:"name"}},{title:"value",dataIndex:"val",width:"30%",scopedSlots:{customRender:"val"}},{title:"备注",dataIndex:"memo",width:"30%",placeholder:"请添加备注",scopedSlots:{customRender:"memo"}},{title:"操作",dataIndex:"operation",width:"20%",align:"center",scopedSlots:{customRender:"operation"}}],p={data:function(){return this.cacheData=l.map((function(t){return u({},t)})),{itemData:[],changeData:"",columns:d,id:0,loading:!1,options:[],name:"",val:"",memo:"",errorMsg:"",tableData:[],canManage:!1}},created:function(){this.getAllList()},methods:{getAllList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.loading=!0,this.$api.config.getConfigList({groupId:this.$route.query.groupId}).then((function(t){a.loading=!1,a.tableData=t.data,a.canManage=t.ext.canManage,a.changeData="";for(var e=0;e<a.tableData.length;e++){var n=a.tableData[e];a.changeData+="".concat(n.name,"=").concat(n.val,"\n")}})),e=JSON.parse(localStorage.getItem("rcc-info")),this.projectName=e.projectName,this.projectId=e.projectId,this.productName=e.productName,this.productId=e.productId,this.environmentId=e.environmentId,this.environmentName=e.environmentName,this.versionId=e.versionId,this.versionName=e.versionName,this.groupName=e.groupName,this.groupId=e.groupId;case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleDelete:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$api.config.deleteConfig(e.id).then((function(t){0===t.status?(a.$message.success("删除成功"),a.getAllList()):a.$message.error(t.msg)}));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleChange:function(t,e,a,n){var r=Object(i["a"])(this.tableData),o=r.filter((function(t){return e===t.key}))[n];o&&(o[a]=t,this.tableData=r)},edit:function(t,e){var a=Object(i["a"])(this.tableData),n=a.filter((function(e){return t===e.key}))[e];n&&(n.editable=!0,this.tableData=a)},save:function(t,e){var a=this,n=Object(i["a"])(this.tableData),r=n.filter((function(e){return t===e.key}))[e];r&&(this.tableData=n,this.cacheData=n.map((function(t){return u({},t)}))),this.$api.config.addConfig(u(u({},r),{},{groupId:this.groupId,groupName:this.groupName,versionId:this.versionId,versionName:this.versionName})).then((function(t){0===t.status?(delete r.editable,a.$message.success("操作成功"),a.getAllList()):a.$message.error(t.msg)})).catch((function(t){a.$message.error(t.msg)}))},cancel:function(t,e){var a=Object(i["a"])(this.tableData),n=a.filter((function(e){return t===e.key}))[e];n&&(Object.assign(n,this.cacheData.filter((function(e){return t===e.key}))[e]),delete n.editable,this.tableData=a),this.getAllList()},addList:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){var e,a,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.changeData.split(/[\n]/g).filter((function(t){return t})),a=[],e.map((function(t,e){var n=t.indexOf("=");a[e]={name:t.substring(0,n),val:t.substring(n+1)}})),this.$api.config.batchConfig({groupId:this.groupId,items:a}).then((function(t){0===t.status?(n.$message.success("保存成功"),n.getAllList()):n.$message.error(t.msg)}));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addNewData:function(){var t=this.tableData;this.tableData=[].concat(Object(i["a"])(t),[{id:0,name:"",val:"",memo:"",editable:!0}])},routerTo:function(t){this.$router.push({path:t})}}},f=p,m=(a("b3a9"),a("2877")),b=Object(m["a"])(f,n,r,!1,null,"ef6f83d6",null);e["default"]=b.exports}}]);