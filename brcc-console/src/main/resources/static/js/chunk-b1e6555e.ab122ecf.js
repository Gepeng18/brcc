(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1e6555e"],{"1ad9":function(e,t,a){},"1bf1":function(e,t,a){"use strict";a("6d67"),a("c5f6");var r,n,o=a("f933"),i=a("ed08"),s={name:"Ellipsis",components:{Tooltip:o["a"]},props:{prefixCls:{type:String,default:"ant-pro-ellipsis"},tooltip:{type:Boolean},length:{type:Number,required:!0},lines:{type:Number,default:1},fullWidthRecognition:{type:Boolean,default:!1}},methods:{getStrDom:function(e,t){var a=this.$createElement;return a("span",[Object(i["a"])(e,this.length)+(t>this.length?"...":"")])},getTooltip:function(e,t){var a=this.$createElement;return a(o["a"],[a("template",{slot:"title"},[e]),this.getStrDom(e,t)])}},render:function(){var e=this.$props,t=e.tooltip,a=e.length,r=this.$slots.default.map((function(e){return e.text})).join(""),n=Object(i["c"])(r),o=t&&n>a?this.getTooltip(r,n):this.getStrDom(r,n);return o}},c=s,l=a("2877"),d=Object(l["a"])(c,r,n,!1,null,null,null);t["a"]=d.exports},"4c93":function(e,t,a){"use strict";a("1ad9")},"5dbc":function(e,t,a){var r=a("d3f4"),n=a("8b97").set;e.exports=function(e,t,a){var o,i=t.constructor;return i!==a&&"function"==typeof i&&(o=i.prototype)!==a.prototype&&r(o)&&n&&n(e,o),e}},"6d67":function(e,t,a){"use strict";var r=a("5ca1"),n=a("0a49")(1);r(r.P+r.F*!a("2f21")([].map,!0),"Array",{map:function(e){return n(this,e,arguments[1])}})},"83fb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"list-project"},[a("section",{staticClass:"add-btn"},[a("a-breadcrumb",{staticClass:"title"},[a("a-breadcrumb-item",{staticClass:"font-menu"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.routerTo("/index")}}},[e._v("首页")])]),a("a-breadcrumb-item",[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.routerTo("/productLine")}}},[e._v(e._s(e.productName))])]),a("a-breadcrumb-item",[e._v("工程列表 ")])],1),e.canManage?a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("\n            新建工程\n        ")]):e._e()],1),a("a-divider",{staticClass:"divider"}),a("section",{staticClass:"content"},[a("a-table",{attrs:{columns:e.columns,"data-source":e.projectdata,"row-key":function(e){return e.id},pagination:e.pagination,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"name",fn:function(t,r){return[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.routerEnvironment(r)}}},[e._v(e._s(t))])]}},{key:"mailReceiver",fn:function(t){return[a("ellipsis",{attrs:{length:60,tooltip:""}},[e._v(e._s(t))])]}},{key:"operating",fn:function(t,r){return[r.admin?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]):e._e(),r.admin?a("a-divider",{attrs:{type:"vertical"}}):e._e(),r.admin?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.routerRole(r)}}},[e._v("权限管理")]):e._e(),r.admin&&r.projectType?a("a-divider",{attrs:{type:"vertical"}}):e._e(),r.projectType&&r.admin?a("a-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(t){return e.handleDelete(r)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("删除")])]):e._e(),r.admin?a("a-divider",{attrs:{type:"vertical"}}):e._e(),a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.routerEnvironment(r)}}},[e._v("管理环境")]),e.canManage?a("a-divider",{attrs:{type:"vertical"}}):e._e(),e.canManage?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.handleEditPassWord(r)}}},[e._v("修改api密码")]):e._e()]}}])}),a("projectdialog",{attrs:{dialog:e.dialog,formdata:e.formdata},on:{update:e.getProjectInfo}}),a("usersmodal",{attrs:{usersdialog:e.usersdialog,usersdata:e.usersdata}}),a("dependmodal",{attrs:{dependdialog:e.dependdialog,dependencydata:e.dependencydata},on:{update:e.getProjectInfo}}),a("update-api",{attrs:{dialog:e.apidialog},on:{update:e.getProjectInfo}})],1)],1)])},n=[],o=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("d25f"),a("ac6a"),a("456d"),a("c5f6"),a("28a5"),a("6d67"),a("96cf"),a("3b8d")),i=(a("7f7f"),a("bd86")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"projectdialog"},[a("a-modal",{attrs:{title:e.dialog.title,visible:e.dialog.show,"mask-closable":!1,"confirm-loading":e.dialog.loading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form",{attrs:{form:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"id"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{initialValue:e.formdata.id}],expression:"['id',{initialValue:formdata.id}]"}]})],1),a("a-form-item",{attrs:{label:"工程名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入工程名称！"}],initialValue:e.formdata.name}],expression:"[\n                    'name',\n                    {\n                        rules: [{ required: true, message: '请输入工程名称！'}],\n                        initialValue: formdata.name\n                    }]"}]})],1),a("a-form-item",{attrs:{label:"简介",form:e.form}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["memo",{initialValue:e.formdata.memo}],expression:"['memo', {initialValue: formdata.memo}]"}],attrs:{type:"textarea"}})],1),"add"===e.dialog.option?a("a-form-item",{attrs:{label:"api密码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["apiPassword",{rules:[{required:!0,message:"请输入api密码！"}],initialValue:e.formdata.apiPassword}],expression:"['apiPassword', {rules: [{ required: true, message: '请输入api密码！'}],initialValue: formdata.apiPassword}]"}]})],1):e._e(),a("a-form-item",{attrs:{label:"邮件接收人"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mailReceiver",{initialValue:e.formdata.mailReceiver}],expression:"['mailReceiver', {initialValue: formdata.mailReceiver}]"}],attrs:{type:"textarea"}})],1)],1)],1)],1)},c=[];function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={data:function(){return{form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}}},props:{dialog:Object,formdata:Object},methods:{handleOk:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.preventDefault(),this.form.validateFields((function(e){if(!e){a.dialog.loading=!0;var t="add"===a.dialog.option?"addProject":"updateProject";a.$api.project[t](d({productId:a.$route.query.productId},a.form.getFieldsValue())).then((function(e){0===e.status?(a.$emit("update"),a.dialog.show=!1,a.$message.success("操作成功！"),a.form.resetFields()):a.$message.error(e.msg)})).finally((function(){a.dialog.loading=!1}))}}));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleCancel:function(e){this.dialog.show=!1,this.form.resetFields()}}},p=u,f=a("2877"),m=Object(f["a"])(p,s,c,!1,null,null,null),h=m.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"usersmodal"},[a("a-modal",{attrs:{title:"分配权限",visible:e.usersdialog.show,"mask-closable":!1},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form-item",{attrs:{label:"分配权限给","label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",value:e.value,placeholder:"请选择"},on:{change:e.handleChange}},e._l(e.usersdata,(function(t){return a("a-select-option",{key:t.id},[e._v("\n                    "+e._s(t.role)+"\n                ")])})),1)],1)],1)],1)},v=[],b={data:function(){return{value:void 0,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}}},props:{usersdialog:Object,usersdata:Array},methods:{handleOk:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios({method:"POST",url:"api/v1/accessSettings",params:{token:localStorage.getItem("token")},data:{userId:this.value,refId:this.usersdialog.id}});case 2:this.$message.success("分配成功！",3),this.usersdialog.show=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleCancel:function(e){this.usersdialog.show=!1},handleChange:function(e){this.value=e}}},j=b,w=Object(f["a"])(j,g,v,!1,null,null,null),y=w.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dependmodal"},[a("a-modal",{attrs:{title:"添加依赖",visible:e.dependdialog.show,"mask-closable":!1,width:600},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form",{attrs:{form:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-item",{attrs:{label:"添加依赖的公共工程"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["dependencyNames",{initialValue:e.dependdialog.dependIds}],expression:"['dependencyNames', {initialValue: dependdialog.dependIds}]"}],attrs:{mode:"multiple","allow-clear":""}},e._l(e.dependencydata,(function(t){return a("a-select-option",{key:t.id},[e._v(e._s(t.name))])})),1)],1)],1)],1)],1)},I=[],_={data:function(){return{form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:14}}}},props:{dependdialog:Object,dependencydata:Array},methods:{handleOk:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios({method:"POST",url:"api/v1/projects/".concat(this.dependdialog.id,"/ref"),params:{token:localStorage.getItem("token")},data:{refIds:this.form.getFieldValue("dependencyNames")}});case 2:this.$message.success("添加成功！",3),this.$emit("update"),this.form.resetFields(),this.dependdialog.show=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleCancel:function(e){this.dependdialog.show=!1,this.form.resetFields()}}},P=_,x=Object(f["a"])(P,O,I,!1,null,null,null),k=x.exports,N=a("1bf1"),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"projectdialog"},[a("a-modal",{attrs:{title:"修改api密码",visible:e.dialog.show,"mask-closable":!1,"confirm-loading":e.dialog.loading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form",{attrs:{form:e.form,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"id"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{initialValue:e.dialog.id}],expression:"['id',{initialValue:dialog.id}]"}]})],1),a("a-form-item",{attrs:{label:"api密码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["apiPassword",{rules:[{required:!0,message:"请输入api密码！"}]}],expression:"['apiPassword', {rules: [{ required: true, message: '请输入api密码！'}]}]"}]})],1)],1)],1)],1)},C=[];function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={data:function(){return{form:this.$form.createForm(this),labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}}},props:{dialog:Object},methods:{handleOk:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.preventDefault(),this.form.validateFields((function(e){e||(a.dialog.loading=!0,a.$api.project.updateApiPassword(a.dialog.projectId,$({},a.form.getFieldsValue())).then((function(e){0===e.status?(a.$emit("update"),a.dialog.show=!1,a.$message.success("操作成功！"),a.form.resetFields()):a.$message.error(e.msg)})).finally((function(){a.dialog.loading=!1})))}));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleCancel:function(e){this.dialog.show=!1,this.form.resetFields()}}},T=R,F=Object(f["a"])(T,S,C,!1,null,null,null),D=F.exports;function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q=[{title:"工程ID",dataIndex:"id",align:"center"},{title:"工程名",dataIndex:"name",align:"center",scopedSlots:{customRender:"name"}},{title:"工程简介",dataIndex:"memo",align:"center"},{title:"邮件接收人",dataIndex:"mailReceiver",align:"center",scopedSlots:{customRender:"mailReceiver"}},{title:"操作",dataIndex:"operating",scopedSlots:{customRender:"operating"},align:"left"}],M={name:"listProject",components:{projectdialog:h,usersmodal:y,dependmodal:k,Ellipsis:N["a"],updateApi:D},data:function(){return{projectdata:[],pagination:{total:0,current:1,pageSize:10,sortBy:"id desc",hideOnSinglePage:!0,showTotal:function(e,t){return"显示 ".concat(t[0]," ~ ").concat(t[1]," 条记录，共 ").concat(e," 条记录")}},pageSize:10,curPage:1,total:0,columns:q,value:"",dialog:{show:!1,title:"",option:"",label:""},usersdialog:{show:!1,id:""},apidialog:{show:!1,id:""},usersdata:[],dependdialog:{show:!1,id:"",dependIds:""},dependencydata:[],formdata:{name:"",memo:"",mailReceiver:"",projectType:"1"},routes:[{path:"listProject",breadcrumbName:"工程列表"}],loading:!1,canManage:!1,productName:""}},created:function(){this.getProjectInfo()},methods:{getProjectInfo:function(){var e=this;this.loading=!0,this.$api.project.getProjectList({productId:this.$route.query.productId,pageNo:this.pagination.current,pageSize:this.pagination.pageSize}).then((function(t){0===t.status?(e.projectdata=t.data.dataList||[],e.pagination.total=t.data.total||0,e.canManage=t.ext.canManage):(e.$message.error(t.msg),e.loading=!1)})).finally((function(){e.loading=!1}));var t=JSON.parse(localStorage.getItem("rcc-info"));this.productName=t.productName,this.productId=t.productId},handleTableChange:function(e){this.pagination.current=e.current,this.getProjectInfo()},routerEnvironment:function(e){localStorage.setItem("rcc-info",JSON.stringify(A(A({},JSON.parse(localStorage.getItem("rcc-info"))),{},{projectId:e.id,projectName:e.name}))),this.$router.push({path:"/listEnv",query:{projectId:e.id}})},routerRole:function(e){localStorage.setItem("rcc-info",JSON.stringify(A(A({},JSON.parse(localStorage.getItem("rcc-info"))),{},{projectId:e.id,projectName:e.name}))),this.$router.push({path:"/productLine/roleManage",query:{projectId:e.id,productId:e.productId}})},handleAdd:function(){this.dialog={show:!0,title:"新建工程",option:"add",loading:!1},this.formdata={id:"",name:"",memo:"",mailReceiver:"",projectType:1}},handleEdit:function(e){this.dialog={show:!0,title:"编辑工程",option:"edit",loading:!1},this.formdata=A({},e)},handleDelete:function(e){var t=this;this.$api.project.deleteProject(e.id).then((function(e){0===e.status?(t.$message.success("删除成功！"),t.getProjectInfo()):t.$message.error(e.msg)}))},getuserlist:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$api.project.getUserList({projectId:t}).then((function(e){a.usersdata=e.data}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),assignPermission:function(e){this.getuserlist(e.id),this.usersdialog={show:!0,id:e.id}},handleAddDependency:function(e){this.dependdialog={show:!0,dependIds:e.dependencyIds?e.dependencyIds.split(",").map(Number):void 0,id:e.id}},getDependencyList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.axios({method:"GET",url:"api/v1/projects",params:{token:localStorage.getItem("token"),projectType:"0"}});case 2:t=e.sent,this.dependencydata=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleEditPassWord:function(e){console.log(e),this.apidialog={show:!0,id:e.productId,projectId:e.id},console.log(this.apidialog)},routerTo:function(e){this.$router.push(e)}}},L=M,J=(a("4c93"),Object(f["a"])(L,r,n,!1,null,"5543ca58",null));t["default"]=J.exports},"8b97":function(e,t,a){var r=a("d3f4"),n=a("cb7c"),o=function(e,t){if(n(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{r=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),r(e,[]),t=!(e instanceof Array)}catch(n){t=!0}return function(e,a){return o(e,a),t?e.__proto__=a:r(e,a),e}}({},!1):void 0),check:o}},aa77:function(e,t,a){var r=a("5ca1"),n=a("be13"),o=a("79e5"),i=a("fdef"),s="["+i+"]",c="​",l=RegExp("^"+s+s+"*"),d=RegExp(s+s+"*$"),u=function(e,t,a){var n={},s=o((function(){return!!i[e]()||c[e]()!=c})),l=n[e]=s?t(p):i[e];a&&(n[a]=l),r(r.P+r.F*s,"String",n)},p=u.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},c5f6:function(e,t,a){"use strict";var r=a("7726"),n=a("69a8"),o=a("2d95"),i=a("5dbc"),s=a("6a99"),c=a("79e5"),l=a("9093").f,d=a("11e9").f,u=a("86cc").f,p=a("aa77").trim,f="Number",m=r[f],h=m,g=m.prototype,v=o(a("2aeb")(g))==f,b="trim"in String.prototype,j=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){t=b?t.trim():p(t,3);var a,r,n,o=t.charCodeAt(0);if(43===o||45===o){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+t}for(var i,c=t.slice(2),l=0,d=c.length;l<d;l++)if(i=c.charCodeAt(l),i<48||i>n)return NaN;return parseInt(c,r)}}return+t};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof m&&(v?c((function(){g.valueOf.call(a)})):o(a)!=f)?i(new h(j(t)),a,m):j(t)};for(var w,y=a("9e1e")?l(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),O=0;y.length>O;O++)n(h,w=y[O])&&!n(m,w)&&u(m,w,d(h,w));m.prototype=g,g.constructor=m,a("2aba")(r,f,m)}},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);